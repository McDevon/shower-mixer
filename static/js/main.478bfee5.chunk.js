(window["webpackJsonpshower-mixer"]=window["webpackJsonpshower-mixer"]||[]).push([[0],{11:function(e,t,i){e.exports=i(17)},16:function(e,t,i){},17:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),a=i(5),s=i.n(a),o=(i(16),function(){return r.a.createElement("div",{style:{textAlign:"right"}},r.a.createElement("p",null,"Copyright (c) Jussi Enroos 2019",r.a.createElement("br",null),r.a.createElement("a",{href:"https://github.com/McDevon/shower-mixer"},"Source")," with MIT license"))}),h=i(6),u=i(10),c=function(e,t){if(void 0!==typeof e.getContext){!function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"]}();var i=e.getContext("2d"),n=(new Date).getTime(),r=0,a=0,s=0,o=0;e.simulation=t,t.init(e);!function e(){for(window.requestAnimationFrame(e),r=(new Date).getTime(),a=Math.min((r-n)/1e3,.03),o=0,(s+=a)<1/60&&(s=1/60);s>=1/60&&o<1;)t.fixedUpdate(1/60),s-=1/60,o++;o>=1&&(s=0),t.update(a),t.render(i),n=r}()}},l=i(2),m=i(3),p=function(){function e(t){Object(l.a)(this,e),this.size=t,this.buffer=[],this.buffer.length=t,this.nextIndex=0}return Object(m.a)(e,[{key:"put",value:function(e){this.buffer[this.nextIndex]=e,this.nextIndex=(this.nextIndex+1)%this.size}},{key:"getHead",value:function(){return this.buffer[(this.nextIndex-1)%this.size]}},{key:"getTail",value:function(){return this.buffer[this.nextIndex]}},{key:"getAll",value:function(){for(var e=this.nextIndex,t=[],i=0;i<this.size;i++)t.push(this.buffer[e]),e=(e+1)%this.size;return t}}]),e}(),f=function(){function e(t,i,n,r,a,s,o,h){Object(l.a)(this,e),this.width=t,this.height=i,this.maxVals=n,this.top=r,this.bottom=a,this.targetTop=o,this.targetBottom=h,this.stepLength=t/n,this.verticalStep=i/(r-a),this.cx=s.getContext("2d")}return Object(m.a)(e,[{key:"draw",value:function(e,t,i){this.cx.strokeStyle="#FFAA00",this.cx.lineWidth=2,this.cx.beginPath();for(var n=0,r=i.length;n<r;n++){var a=i[n],s=e+this.stepLength*n,o=t+this.height-this.verticalStep*(a-this.bottom);0===n?this.cx.moveTo(s,o):this.cx.lineTo(s,o)}this.cx.stroke(),this.cx.strokeStyle="#000000",this.cx.lineWidth=1,this.cx.beginPath(),this.cx.moveTo(e,t),this.cx.lineTo(e,t+this.height),this.cx.moveTo(e,t+this.height/2),this.cx.lineTo(e+this.width,t+this.height/2),this.cx.stroke()}}]),e}(),g=function(){function e(){Object(l.a)(this,e)}return Object(m.a)(e,[{key:"init",value:function(e){this.canvas=e,this.width=e.width,this.height=e.height;this.delayQueue=new p(300),this.running=!0,this.targetTemperature=36,this.minTemperature=15,this.maxTemperature=50,this.maxChangeSpeed=3,this.reset()}},{key:"reset",value:function(){this.currentTemperature=17+6*Math.random(),this.mixerTemperature=this.currentTemperature;for(var e=0;e<this.delayQueue.size;e++)this.delayQueue.put(this.currentTemperature);return this.graphList=new p(1800),this.plotter=new f(550,350,1800,this.maxTemperature,this.minTemperature,this.canvas,this.targetTemperature+.5,this.targetTemperature-.5),this.mixerTemperature}},{key:"setMixer",value:function(e){this.mixerTemperature=this.minTemperature+(this.maxTemperature-this.minTemperature)*(1-e),console.log("Target ".concat(this.mixerTemperature))}},{key:"fixedUpdate",value:function(e){var t=this.mixerTemperature-this.currentTemperature;Math.abs(t)>this.maxChangeSpeed*e&&(t=this.maxChangeSpeed*Math.sign(t)*e),this.currentTemperature+=t;var i=this.delayQueue.getTail();this.delayQueue.put(this.currentTemperature),this.graphList.put(i)}},{key:"update",value:function(e){}},{key:"render",value:function(e){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.plotter.draw(25,25,this.graphList.getAll().filter(function(e){return null!=e}))}}]),e}(),x=function(){return new g},d=i(9),v=function(e){var t=e.value,i=e.step,n=e.min,a=e.max,s=e.onChange;e.suffix;return console.log("Mixer value ".concat(t)),r.a.createElement("div",{style:{marginTop:"5px",marginLeft:"5px",marginRight:"5px",marginBottom:"5px"}},r.a.createElement(d.a,{axis:"y",ystep:i,ymin:n,ymax:a,y:t,onChange:s(),styles:{track:{backgroundColor:"red",height:300},active:{backgroundColor:"blue"}}}))};function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}var y=function(e){var t=Object(n.useState)({mixer:.9}),i=Object(u.a)(t,2),a=i[0],s=i[1],o=Object(n.useRef)(null);return Object(n.useEffect)(function(){console.log("start hook"),console.log(e.location.search),c(o.current,x()),o.current.simulation.setMixer(a.mixer)},[]),r.a.createElement("div",null,r.a.createElement("canvas",{style:{border:" 1px solid #aaa"},ref:o,width:"600",height:"400"}),r.a.createElement("div",{style:{paddingLeft:"25px",paddingRight:"25px"}},r.a.createElement("div",{style:{display:"inline-block",verticalAlign:"top",width:"200px",marginLeft:"5px",marginRight:"5px"}},r.a.createElement(v,{value:a.mixer,min:0,max:1,step:.0025,onChange:function(){return function(e){var t=e.y;return function(e){var t={mixer:e.mixer};s(t),o.current.simulation.setMixer(t.mixer)}(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(i,!0).forEach(function(t){Object(h.a)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},a,{mixer:t}))}}}))))},b=function(e){return Object(n.useEffect)(function(){console.log("app effect")}),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:"600px"}},r.a.createElement(y,{location:window.location}),r.a.createElement(o,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.478bfee5.chunk.js.map